<div class="banner" style="background-image: linear-gradient(rgba(0,0,0,0.4),rgba(0,0,0,0.4)), url('<%=@event.game.image_url%>');">
    <h3><%= @event.game.name %></h3>
</div>
<div class="container">
  <div class="title" >
    <h1><%= @event.name %></h1>
    <p>proposed by <%=@event.user.username%></p>
  </div>
  <div class="event-info">
    <div class="event-description">
      <p><%= @event.description %></p>
    </div>
  </div>
  <ul>
    <li><%= @event.event_type %></li>
    <li><%= @event.date.localtime.strftime("%A, %d %B %Y at %I:%M %p") %></li>
    <li><%= link_to @event.address, "https://www.google.com/maps/place/#{@event.address.gsub(" ", "+")}", target: "_blank" %></li>
    <li><%= @event.status %></li>
  </ul>
  <div class="participations">
    <h2>Participants</h2>
    <div class="d-flex align-item-end">
    <% if @event.participations != [] %>
      <% @event.participations.each do |participation| %>
        <% if participation.user == current_user %>
          <%= image_tag "https://cdn2.f-cdn.com/contestentries/1107446/20762621/599154bb89160_thumb900.jpg", crop: :fill_pad, class: "avatar", alt: "user participation" %>
        <% else %>
          <div class="avatar">
            <%= cl_image_tag participation.user.photo.key, crop: :fill_pad, class: "avatar", alt: "other user" %>
            <p style="w-25"><%=participation.user.username%></p>
          </div>
        <% end %>
      <% end %>
          <p class="p-3"><%= @event.max_players - @event.participations.count %> spots left!</p>
    <% else %>
      <p><% @event.max_players %> spots left! </p>
    <% end %>
    </div>
  </div>
  <% if @event.status != "Cancelled" && @event.status != "Fully booked" %>
    <%= link_to "Game details", game_path(@event.game), class: "game-details" %>
    <% if @registered == false %>
      <%= button_to "Register", event_participations_path(@event), method: :post, class: "register-button"  %>
    <% else %>
      <%= button_to "Cancel my participation", event_participations_path(@event), method: :delete, class: "register-button"  %>
    <% end %>
  <% elsif @event.status == "Cancelled" %>
    <div class="text-danger">This event has been cancelled due to the cancellation of this event cancelling</div>
  <% elsif @event.status == "Fully booked" %>
    <div class="text-danger">This event is fully booked! Comeback later or register to a new one!</div>
  <% end %>
</div>

<%= render "shared/footer" %>
